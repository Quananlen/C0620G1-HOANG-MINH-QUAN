<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Title</title>
</head>
<body>
<div>
    <label for="titleNewEntry">Title</label>
    <input id="titleNewEntry" type="text">
    <label for="contentNewEntry">Content</label>
    <textarea rows=5 id="contentNewEntry"></textarea>
    <input id="newEntry" type="button" value="New Entry">
</div>
<div>
    <input id="idToFind" type="text">
    <input id="findByCategory" type="button" value="find">
</div>
<div>
    <input id="display" type="button" value="display all entry">
    <div id="entryList"></div>
    <input type="button" id="viewMore" value="view more">
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script>
    $("document").ready(function () {
        $("#newEntry").click(function () {
            let title = $("#titleNewEntry").val();
            let content = $("#contentNewEntry").val();
            let blogEntry = {
                "title": title,
                "content": content
            };
            console.log(blogEntry);
            $.ajax({
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                type: "POST",
                data: JSON.stringify(blogEntry),
                url: "http://localhost:8080/blog/api/create",
                success: function (data, statusContent, header) {
                    console.log("1: " + statusContent);
                    console.log("2: " + header.status);
                    // location.href = "https://www.google.com";
                },
                error: function (content) {
                    console.log(content);
                }
            });
        });
        $("#findByCategory").click(function () {
            let id = $("#idToFind").val();
            console.log(id);
            $.ajax({
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                type: "GET",
                url: `http://localhost:8080/blog/api/findByCategory/${id}`,
                success: function (blogEntry, statusText, header) {
                    $("#titleNewEntry").val(blogEntry[0].title);
                    $("#contentNewEntry").val(blogEntry[0].content);
                    console.log(statusText, header.status);
                },
                error: function (content) {
                    console.log(content);
                }
            })
        });

        let str = "";
        let page = 0;
        let list;
        let counter = 0;

        $("#display").click(function () {
            $.ajax({
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                type: "GET",
                url: `http://localhost:8080/blog/api/small-list?page=${page}&size=1`,
                success: function (blogEntryList, statusText, header) {
                    list = blogEntryList;
                    str += blogEntryList[counter].date + "<br>" + blogEntryList[counter].title + "<br>" + blogEntryList[counter].content + "<hr>";
                    // for (let i = 0; i < length; i++) {
                    //     str += blogEntryList[i].date + "<br>" + blogEntryList[i].title + "<br>" + blogEntryList[i].content + "<hr>";
                    // }
                    $("#entryList").html(str);
                    console.log(statusText, header.status);
                    page++;
                },
                error: function (content) {
                    console.log(content);
                }
            })
        });

        $("#viewMore").click(function () {
            str += list[counter].date + "<br>" + list[counter].title + "<br>" + list[counter].content + "<hr>";
            $("#entryList").html(str);
            page++;
        });
    });
</script>
</body>
</html>